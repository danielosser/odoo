<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- TODO: adapt -->
    <data noupdate="1">
        <record id="15_pc_on_next_order" model="coupon.program">
            <field name="name">15% on next order</field>
            <field name="program_type">promotion_program</field>
            <field name="promo_applicability">on_next_order</field>
            <field name="promo_code_usage">no_code_needed</field>
            <field name="rule_minimum_amount">100</field>
            <field name="discount_apply_on">on_order</field>
            <field name="discount_type">percentage</field>
            <field name="discount_percentage">15.0</field>
            <field name="validity_duration">0</field>
        </record>

        <record id="point_of_sale.pos_config_main" model="pos.config">
            <field name="use_coupon_programs">True</field>
            <field name="promo_program_ids" eval="[(6,0,[ref('coupon.3_cabinets_plus_1_free'),ref('coupon.10_percent_auto_applied'),ref('pos_coupon.15_pc_on_next_order')])]"/>
            <field name="coupon_program_ids" eval="[(6,0,[ref('coupon.10_percent_coupon')])]"/>
        </record>

        <function name="create" model="coupon.generate.wizard">
            <value model="coupon.generate.wizard" eval="dict(
                obj().default_get(list(obj().fields_get())),
                **{
                    'nbr_coupons': 10,
                }
            )"/>
        </function>

        <!-- Create 10 coupons for the 10% coupon program based on the created record above -->
        <function name="generate_coupon" model="coupon.generate.wizard">
            <value model="coupon.generate.wizard" eval="obj().search([('nbr_coupons', '=', 10)]).id"/>
            <value name="context" eval="{'active_id': ref('coupon.10_percent_coupon')}" />
        </function>

        <function name="unlink" model="coupon.generate.wizard">
            <value model="coupon.generate.wizard" eval="obj().search([('nbr_coupons', '=', 10)]).id"/>
        </function>
    </data>

    <record id="program" model="loyalty.program">
        <field name="name">Loyalty Program</field>
        <field name="points">10</field>
    </record>
    <record id="simple_pen" model="product.product">
        <field name="available_in_pos">True</field>
        <field name="list_price">1.20</field>
        <field name="name">Simple Pen</field>
        <field name="weight">0.01</field>
        <field name="default_code">CONS_0002</field>
        <field name="uom_id" ref="uom.product_uom_unit" />
        <field name="uom_po_id" ref="uom.product_uom_unit" />
        <field name="image_1920" type="base64" file="pos_loyalty/static/img/simple_pen.png"/>
    </record>

    <record id="reward_01" model="loyalty.reward">
        <field name="name">Free Pen</field>
        <field name="loyalty_program_id" ref="pos_loyalty.program"></field>
        <field name="reward_type">gift</field>
        <field name="point_cost">5</field>
        <field name="gift_product_id" ref="pos_loyalty.simple_pen" />
    </record>

    <function model="pos.config" name="set_loyalty_program_to_main_config" />
</odoo>
