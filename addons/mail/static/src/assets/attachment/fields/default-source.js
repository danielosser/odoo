/** @odoo-module **/

import { Define } from '@mail/define';

export default Define`
    {Field}
        [Field/name]
            defaultSource
        [Field/model]
            Attachment
        [Field/type]
            attr
        [Field/target]
            String
        [Field/compute]
            {if}
                @record
                .{Attachment/isImage}
            .{then}
                /web/image/
            .{+}
                @record
                .{Attachment/id}
            .{+}
                ?signature=
            .{+}
                @record
                .{Attachment/checksum}
            .{elif}
                @record
                .{Attachment/isPdf}
            .{then}
                /web/static/lib/pdfjs/web/viewer.html?file=/web/content/
                .{+}
                    @record
                    .{Attachment/id}
            .{elif}
                @record
                .{Attachment/isUrlYoutube}
            .{then}
                :urlArr
                    @record
                    .{Attachment/url}
                    .{String/split}
                        /
                :token
                    @urlArr
                    .{Collection/last}
                {if}
                    @token
                    .{String/includes}
                        watch
                .{then}
                    :token
                        @token
                        .{String/split}
                            v=
                        .{Collection/second}
                    :amp
                        @token
                        .{String/indexOf}
                            &
                    {if}
                        @amp
                        .{!=}
                            -1
                    .{then}
                        :token
                            @token
                            .{String/substring}
                                0
                                @amp
                https://www.youtube.com/embed/
                .{+}
                    @token
            .{else}
                /web/content/
                .{+}
                    @record
                    .{Attachment/id}
`;
